# Sync schema for integration testing
# This schema defines deterministic test data generation rules.
# Using the same seed produces identical data for verification.
version: 1

tables:
  # Basic types test table
  - name: users
    id:
      type: big_int
      generator:
        type: sequential
        start: 1
    fields:
      - name: email
        type:
          type: var_char
          length: 255
        generator:
          type: pattern
          pattern: "user_{index}@test.com"
      - name: age
        type: int
        generator:
          type: int_range
          min: 18
          max: 80
      - name: is_active
        type: bool
        generator:
          type: weighted_bool
          true_weight: 0.8
      - name: score
        type: double
        generator:
          type: float_range
          min: 0.0
          max: 100.0

  # Decimal and timestamp test table
  - name: orders
    id:
      type: big_int
      generator:
        type: sequential
        start: 1
    fields:
      - name: total
        type:
          type: decimal
          precision: 10
          scale: 2
        generator:
          type: decimal_range
          min: 10.0
          max: 500.0
      - name: status
        type:
          type: var_char
          length: 50
        generator:
          type: one_of
          values: ["pending", "completed", "cancelled", "refunded"]
      - name: created_at
        type: date_time
        generator:
          type: timestamp_range
          start: "2024-01-01T00:00:00Z"
          end: "2024-12-31T23:59:59Z"

  # Complex types test table (UUID, JSON, Array, Enum)
  - name: products
    id:
      type: big_int
      generator:
        type: sequential
        start: 1
    fields:
      # UUID field (not as ID)
      - name: sku
        type: uuid
        generator:
          type: uuid_v4
      # JSON object field
      - name: metadata
        type: json
        generator:
          type: static
          value:
            version: 1
            source: "loadtest"
            tags: ["test", "sample"]
      # Enum field (for databases that support it)
      - name: category
        type:
          type: enum
          values: ["electronics", "clothing", "food", "books", "toys"]
        generator:
          type: one_of
          values: ["electronics", "clothing", "food", "books", "toys"]
      # Array of integers
      - name: ratings
        type:
          type: array
          element_type: int
        generator:
          type: sample_array
          pool: ["1", "2", "3", "4", "5"]
          min_length: 1
          max_length: 5
      # Array of strings (tags)
      - name: tags
        type:
          type: array
          element_type: text
        generator:
          type: sample_array
          pool: ["sale", "new", "featured", "clearance", "popular", "trending"]
          min_length: 0
          max_length: 3
      # Text field for description
      - name: description
        type: text
        generator:
          type: pattern
          pattern: "Product {index} description with some sample text for testing purposes."
